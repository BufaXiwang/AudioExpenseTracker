# 录音模式使用指南

## 🎯 功能概述

AudioExpenseTracker 现在支持两种录音激活模式，让用户可以根据个人喜好选择最适合的录音方式。

## 📱 录音模式

### 1. 点击录音模式 (默认)
- **激活方式**: 点击录音按钮开始，再次点击停止
- **适用场景**: 需要较长时间录音，或者希望有明确的开始/停止控制
- **图标**: 🖱️ 手指点击图标
- **按钮状态**: 
  - 🔵 蓝色麦克风 → 点击开始录音
  - 🔴 红色停止 → 点击停止录音

### 2. 长按录音模式
- **激活方式**: 长按录音按钮录音，松开停止
- **适用场景**: 快速录音，类似微信语音消息
- **图标**: ☝️ 手指长按图标
- **按钮状态**:
  - 🔵 蓝色麦克风 → 长按开始录音
  - 🔴 红色麦克风 → 录音中，松开停止

## 🔄 模式切换

### 切换方法
1. **模式切换按钮**: 点击录音按钮左侧的模式切换按钮
2. **即时生效**: 切换后立即生效，无需重启应用
3. **自动保存**: 用户选择会自动保存到设置中

### 视觉指示
- **指导提示**: 首次使用时显示当前模式的操作说明
- **模式图标**: 切换按钮显示当前模式的图标
- **状态提示**: 录音时显示对应的操作提示

## 🎨 用户体验特性

### 触觉反馈
- **模式切换**: 轻微选择反馈
- **录音开始**: 中等强度冲击反馈
- **录音停止**: 轻微冲击反馈
- **长按开始**: 重度冲击反馈
- **长按结束**: 轻微冲击反馈
- **操作成功**: 成功通知反馈
- **操作错误**: 错误通知反馈

### 动画效果
- **按钮缩放**: 按压时缩小到95%
- **录音状态**: 录音时放大到110%
- **图标旋转**: 处理时图标旋转动画
- **颜色过渡**: 状态变化时平滑颜色过渡

### 状态指示
- **实时提示**: 录音时显示对应模式的操作提示
- **音频波形**: 录音时显示实时音频电平
- **进度反馈**: 处理和分析时显示进度指示器

## 🛠️ 技术实现

### 手势识别
```swift
// 点击模式
Button {
    if settingsManager.recordingMode == .tap {
        await handleTapMode()
    }
}

// 长按模式
LongPressGesture(minimumDuration: 0.1)
    .onChanged { _ in
        if settingsManager.recordingMode == .holdToRecord {
            await handleLongPressStart()
        }
    }
    .onEnded { _ in
        if settingsManager.recordingMode == .holdToRecord {
            handleLongPressEnd()
        }
    }
```

### 设置持久化
- **UserDefaults**: 使用UserDefaults保存用户偏好
- **自动同步**: 设置变化时自动保存
- **默认值**: 首次启动时设置合理默认值

### 状态管理
- **模式感知**: 按钮行为根据当前模式调整
- **状态同步**: UI状态与录音状态实时同步
- **错误处理**: 不同模式下的错误处理策略

## 📋 使用建议

### 点击录音模式适合：
- 📝 **详细记账**: 需要说明较多细节的费用
- 🎯 **精确控制**: 希望明确控制录音开始和结束
- 🔄 **多次尝试**: 可能需要重新录音的场景
- 📱 **单手操作**: 可以放下手机继续录音

### 长按录音模式适合：
- ⚡ **快速记账**: 简单的费用记录
- 🚶 **移动场景**: 走路或忙碌时的快速记录
- 💬 **习惯用户**: 习惯微信语音消息的用户
- 🎯 **精准控制**: 录音时长完全由用户控制

## ⚙️ 设置选项

### 可配置项
- **录音模式**: 点击录音 / 长按录音
- **显示指导**: 是否显示操作指导提示
- **触觉反馈**: 是否启用触觉反馈
- **自动保存**: 录音后是否自动保存（未来功能）

### 设置位置
- **快速切换**: 主界面左下角模式切换按钮
- **详细设置**: 设置页面中的录音偏好设置（未来功能）

## 🔮 未来扩展

### 计划功能
- **手势录音**: 摇一摇开始录音
- **语音唤醒**: "Hey Siri, 开始记账"
- **快捷指令**: iOS快捷指令集成
- **Apple Watch**: 手表端录音支持

### 高级模式
- **混合模式**: 同时支持点击和长按
- **自定义手势**: 用户自定义录音手势
- **智能模式**: 根据使用习惯自动切换模式

## 💡 使用技巧

1. **首次使用**: 建议先尝试两种模式，找到最适合的方式
2. **场景切换**: 可以根据不同场景灵活切换模式
3. **触觉反馈**: 建议开启触觉反馈以获得更好的操作体验
4. **指导提示**: 熟悉操作后可以关闭指导提示
5. **错误恢复**: 录音出错时点击错误状态按钮可以重新开始

## 🎉 总结

双录音模式设计让AudioExpenseTracker能够适应不同用户的使用习惯和场景需求，无论是喜欢精确控制的用户还是追求快速便捷的用户，都能找到适合自己的录音方式。配合丰富的触觉反馈和动画效果，提供了流畅自然的用户体验。 